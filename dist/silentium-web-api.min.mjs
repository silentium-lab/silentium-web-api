import{Message as e,Transport as t}from"silentium";function r(r,o,n){return e((e=>{const s=new AbortController;n&&n.to(t((e=>{e&&s.abort()}))),r.to(t((t=>{const{baseUrl:r,url:n,method:c,credentials:i,headers:u,body:a,query:l}=t;let d;try{d=new URL(String(n),r)}catch{return void o?.use(new Error("Invalid URL"))}Object.entries(l??{}).forEach((([e,t])=>d.searchParams.append(e,String(t))));const f={method:c,credentials:i,headers:u,body:a,signal:s.signal};fetch(d.toString(),f).then((e=>e.text())).then((t=>e.use(t))).catch((e=>{e?.(e)}))})))}))}function o(r,o){return e((e=>{r.to(t((t=>{try{e.use({...t,headers:{...t.headers??{},"Content-Type":"application/json"},body:JSON.stringify(t.body)})}catch{o?.use(new Error("Failed to parse JSON"))}})))}))}function n(r){return e((e=>{r.to(t((t=>{const r=document.querySelectorAll(t);if(r.length>0)e.use(Array.from(r));else{const r=document,o={childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","id"]},n=new MutationObserver((r=>{for(const o of r)if("childList"===o.type){if((r=>{for(const o of Array.from(r))if(o.nodeType===Node.ELEMENT_NODE){const r=o;if(r.matches&&r.matches(t)){const r=document.querySelectorAll(t);if(r.length>0)return e.use(Array.from(r)),n.disconnect(),!0}if(r.querySelector&&r.querySelector(t)){const r=document.querySelectorAll(t);if(r.length>0)return e.use(Array.from(r)),n.disconnect(),!0}}return!1})(o.addedNodes))break}else if("attributes"===o.type){const r=o.target;if(r.matches&&r.matches(t)){const r=document.querySelectorAll(t);if(r.length>0){e.use(Array.from(r)),n.disconnect();break}}}}));n.observe(r,o)}})))}))}function s(r){return e((e=>{r.to(t((t=>{const r=document.querySelector(t);if(r)e.use(r);else{const r=document,o={childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","id"]},n=new MutationObserver((r=>{for(const o of r)if("childList"===o.type){if((r=>{for(const o of Array.from(r))if(o.nodeType===Node.ELEMENT_NODE){const r=o;if(r.matches&&r.matches(t))return e.use(r),n.disconnect(),!0;if(r.querySelector&&r.querySelector(t)){const o=r.querySelector(t);return e.use(o),n.disconnect(),!0}}return!1})(o.addedNodes))break}else if("attributes"===o.type){const r=o.target;if(r.matches&&r.matches(t)){e.use(r),n.disconnect();break}}}));n.observe(r,o)}})))}))}function c(e){return t((t=>{console.log(e,t)}))}function i(t){return e((e=>{setTimeout((()=>{e.use(t)}),t)}))}export{s as Element,n as Elements,r as FetchedData,c as Log,o as RequestJson,i as Timer};
//# sourceMappingURL=silentium-web-api.min.mjs.map
